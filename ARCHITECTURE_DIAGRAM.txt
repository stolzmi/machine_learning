╔══════════════════════════════════════════════════════════════════════════════╗
║                    CIFAR-10 CNN with XAI Architecture                        ║
╚══════════════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────────────────┐
│                              INPUT IMAGE                                     │
│                         32 × 32 × 3 (RGB)                                   │
└────────────────────────────────┬────────────────────────────────────────────┘
                                 │
                                 ▼
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃                            BLOCK 1                                          ┃
┃  ┌──────────────────┐    ┌──────────────────┐                              ┃
┃  │   Conv 3×3, 64   │ -> │   Conv 3×3, 64   │                              ┃
┃  │   BatchNorm      │    │   BatchNorm      │                              ┃
┃  │   ReLU           │    │   ReLU           │                              ┃
┃  └──────────────────┘    └──────────────────┘                              ┃
┃           │                        │                                         ┃
┃           └────────────┬───────────┘                                         ┃
┃                        ▼                                                     ┃
┃                  MaxPool 2×2                                                 ┃
┃               Output: 16×16×64                                               ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
                            │
                            ▼
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃                            BLOCK 2                                          ┃
┃  ┌──────────────────┐    ┌──────────────────┐                              ┃
┃  │   Conv 3×3, 128  │ -> │   Conv 3×3, 128  │                              ┃
┃  │   BatchNorm      │    │   BatchNorm      │                              ┃
┃  │   ReLU           │    │   ReLU           │                              ┃
┃  └──────────────────┘    └──────────────────┘                              ┃
┃           │                        │                                         ┃
┃           └────────────┬───────────┘                                         ┃
┃                        ▼                                                     ┃
┃                  MaxPool 2×2                                                 ┃
┃               Output: 8×8×128                                                ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
                            │
                            ▼
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃                            BLOCK 3                                          ┃
┃  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                        ┃
┃  │ Conv 3×3    │  │ Conv 3×3    │  │ Conv 3×3    │                        ┃
┃  │ 256         │->│ 256         │->│ 256         │                        ┃
┃  │ BatchNorm   │  │ BatchNorm   │  │ BatchNorm   │                        ┃
┃  │ ReLU        │  │ ReLU        │  │ ReLU        │                        ┃
┃  └─────────────┘  └─────────────┘  └─────────────┘                        ┃
┃           │              │              │                                    ┃
┃           └──────────────┴──────────────┘                                   ┃
┃                        │                                                     ┃
┃                        │ <-- TARGET LAYER FOR GRADCAM                       ┃
┃                        ▼                                                     ┃
┃                  MaxPool 2×2                                                 ┃
┃               Output: 4×4×256                                                ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
                            │
                            ▼
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃                       CLASSIFICATION HEAD                                   ┃
┃                                                                              ┃
┃                   Global Average Pooling                                    ┃
┃                     Output: 1×1×256                                         ┃
┃                            │                                                 ┃
┃                            ▼                                                 ┃
┃                   ┌──────────────────┐                                      ┃
┃                   │  Dense(512)      │                                      ┃
┃                   │  ReLU            │                                      ┃
┃                   │  Dropout(0.5)    │                                      ┃
┃                   └──────────────────┘                                      ┃
┃                            │                                                 ┃
┃                            ▼                                                 ┃
┃                   ┌──────────────────┐                                      ┃
┃                   │  Dense(10)       │                                      ┃
┃                   │  (Logits)        │                                      ┃
┃                   └──────────────────┘                                      ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
                            │
                            ▼
                   ┌──────────────────┐
                   │  Softmax         │
                   │  (10 classes)    │
                   └──────────────────┘
                            │
                            ▼
                   ┌──────────────────┐
                   │  PREDICTIONS     │
                   └──────────────────┘


╔══════════════════════════════════════════════════════════════════════════════╗
║                             XAI METHODS                                      ║
╚══════════════════════════════════════════════════════════════════════════════╝


1. GRADCAM (Gradient-weighted Class Activation Mapping)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   Input Image                Target Layer (Block 3)         Class Score
       │                              │                            │
       │                              │                            │
       ▼                              ▼                            ▼
   ┌────────┐     Forward      ┌──────────────┐           ┌─────────────┐
   │  32×32 │ ===============> │ Activations  │ ========> │   Logits    │
   │   ×3   │                  │   4×4×256    │           │     10      │
   └────────┘                  └──────────────┘           └─────────────┘
                                      │                           │
                                      │                           │
                                      │    <== Backprop Gradients │
                                      ▼                           │
                               ┌──────────────┐                  │
                               │  Gradients   │ <════════════════┘
                               │   4×4×256    │
                               └──────────────┘
                                      │
                                      ▼
                            Global Average Pool
                                      │
                                      ▼
                               ┌──────────────┐
                               │   Weights    │
                               │     256      │
                               └──────────────┘
                                      │
                                      ▼
                         Weighted Sum of Activations
                                      │
                                      ▼
                                  ReLU + Normalize
                                      │
                                      ▼
                               ┌──────────────┐
                               │  Heatmap     │
                               │    4×4       │
                               └──────────────┘
                                      │
                                      ▼
                            Resize to 32×32 (bilinear)
                                      │
                                      ▼
                               ┌──────────────┐
                               │  GradCAM     │
                               │   32×32      │
                               └──────────────┘


2. SALIENCY MAP
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   Input Image              Gradient Flow                Class Score
       │                                                      │
       │                                                      │
       ▼                                                      ▼
   ┌────────┐          Forward Pass                   ┌─────────────┐
   │  32×32 │ =======================================> │   Logits    │
   │   ×3   │                                          │     10      │
   └────────┘                                          └─────────────┘
       │                                                      │
       │                                                      │
       │         <======= Compute Gradients ═════════════════┘
       ▼
   ┌────────┐
   │∂Loss   │
   │──────  │  <== Gradient w.r.t. input pixels
   │∂Input  │
   │ 32×32×3│
   └────────┘
       │
       ▼
   Max across color channels
       │
       ▼
   ┌────────┐
   │Saliency│
   │  32×32 │
   └────────┘


3. SMOOTH SALIENCY (SmoothGrad)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   Original Image
       │
       ├─────┬─────┬─────┬─────┬───── ... (N samples)
       │     │     │     │     │
       ▼     ▼     ▼     ▼     ▼
   ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐
   │+ε₁ │ │+ε₂ │ │+ε₃ │ │+ε₄ │ │+εₙ │  <== Add Gaussian noise
   └────┘ └────┘ └────┘ └────┘ └────┘
       │     │     │     │     │
       ▼     ▼     ▼     ▼     ▼
   Compute Saliency for each
       │     │     │     │     │
       ▼     ▼     ▼     ▼     ▼
   ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐
   │ S₁ │ │ S₂ │ │ S₃ │ │ S₄ │ │ Sₙ │
   └────┘ └────┘ └────┘ └────┘ └────┘
       │     │     │     │     │
       └─────┴─────┴─────┴─────┘
                  │
                  ▼
            Average All
                  │
                  ▼
           ┌──────────────┐
           │    Smooth    │
           │   Saliency   │
           │    32×32     │
           └──────────────┘


╔══════════════════════════════════════════════════════════════════════════════╗
║                         TRAINING PIPELINE                                    ║
╚══════════════════════════════════════════════════════════════════════════════╝

   ┌──────────────┐
   │  CIFAR-10    │
   │   Dataset    │
   └──────┬───────┘
          │
          ├──────────────────┬───────────────────┐
          │                  │                   │
          ▼                  ▼                   ▼
   ┌──────────┐       ┌──────────┐       ┌──────────┐
   │  Train   │       │   Val    │       │   Test   │
   │  (45K)   │       │  (5K)    │       │  (10K)   │
   └────┬─────┘       └────┬─────┘       └────┬─────┘
        │                  │                   │
        │ Normalize        │ Normalize         │ Normalize
        │ Shuffle          │                   │
        │ Batch(128)       │ Batch(128)        │ Batch(128)
        │                  │                   │
        ▼                  │                   │
   ┌──────────┐            │                   │
   │ Training │            │                   │
   │   Loop   │            │                   │
   └────┬─────┘            │                   │
        │                  │                   │
   ┌────▼─────────────┐    │                   │
   │  For each epoch: │    │                   │
   │                  │    │                   │
   │  1. Forward      │    │                   │
   │  2. Loss         │ <──┘ (Validation)     │
   │  3. Backward     │                        │
   │  4. Update       │                        │
   │  5. Validate     │                        │
   └────┬─────────────┘                        │
        │                                      │
        │ Save Best Model                     │
        │                                      │
        ▼                                      │
   ┌──────────┐                                │
   │  Trained │                                │
   │  Model   │ <══════════════════════════════┘
   └────┬─────┘              (Final Test)
        │
        ▼
   ┌──────────┐
   │   XAI    │
   │  Demo    │
   └──────────┘


╔══════════════════════════════════════════════════════════════════════════════╗
║                        MODEL STATISTICS                                      ║
╚══════════════════════════════════════════════════════════════════════════════╝

  Layer Type          Output Shape      Parameters    FLOPs
  ─────────────────────────────────────────────────────────────
  Input               32×32×3           0             -

  Conv1_1             32×32×64          1,728         1.8M
  Conv1_2             32×32×64          36,864        37.7M
  MaxPool             16×16×64          0             -

  Conv2_1             16×16×128         73,728        18.9M
  Conv2_2             16×16×128         147,456       37.7M
  MaxPool             8×8×128           0             -

  Conv3_1             8×8×256           294,912       18.9M
  Conv3_2             8×8×256           589,824       37.7M
  Conv3_3             8×8×256           589,824       37.7M
  MaxPool             4×4×256           0             -

  GlobalAvgPool       256               0             -
  FC1                 512               131,072       0.1M
  Dropout             512               0             -
  FC_out              10                5,120         5K
  ─────────────────────────────────────────────────────────────
  Total                                 ~1.9M         ~190M


╔══════════════════════════════════════════════════════════════════════════════╗
║                          FILE STRUCTURE                                      ║
╚══════════════════════════════════════════════════════════════════════════════╝

advanced_machine_learning/
│
├── cifar10_cnn_model.py          # Model definition
├── xai_visualizations.py         # XAI implementations
├── train_cifar10.py              # Training script
├── demo_xai.py                   # XAI demo
│
├── simple_xai_demo.py            # Quick demo
├── quick_test.py                 # Fast test
│
├── xai_interactive.ipynb         # Jupyter notebook
│
├── README_CIFAR10_XAI.md         # Full documentation
├── GETTING_STARTED.md            # Quick start guide
├── PROJECT_SUMMARY.md            # Project overview
├── ARCHITECTURE_DIAGRAM.txt      # This file
│
├── requirements.txt              # Dependencies
│
├── cifar10_model.pkl            # (generated) Trained model
├── training_history.png         # (generated) Training curves
│
└── xai_results/                 # (generated) Visualizations
    ├── xai_airplane_True.png
    ├── xai_cat_False.png
    ├── batch_visualization.png
    └── ...


╔══════════════════════════════════════════════════════════════════════════════╗
║                         USAGE WORKFLOW                                       ║
╚══════════════════════════════════════════════════════════════════════════════╝

    START
      │
      ▼
  Install Dependencies
  (pip install -r requirements.txt)
      │
      ├─────────────────────┐
      │                     │
      ▼                     ▼
  Quick Demo          Full Pipeline
  (simple_xai_demo.py)     │
      │                     ▼
      │              Train Model
      │           (train_cifar10.py)
      │                     │
      │                     ▼
      │              Load Model
      │                     │
      └──────┬──────────────┘
             │
             ▼
        Run XAI Demo
        (demo_xai.py)
             │
             ▼
      Explore Results
      (xai_results/)
             │
             ▼
     Interactive Analysis
   (xai_interactive.ipynb)
             │
             ▼
          END


═══════════════════════════════════════════════════════════════════════════════

                        Project Complete! ✓

═══════════════════════════════════════════════════════════════════════════════
